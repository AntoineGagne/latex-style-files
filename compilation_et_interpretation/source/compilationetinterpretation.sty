\RequirePackage{iftex}
\RequirePackage{siunitx}
\RequirePackage{microtype}
\RequirePackage{xparse}

\ifLuaTeX%
\RequirePackage{fontspec}
\RequirePackage{lualatex-math}
\RequirePackage{luacode}
\setmonofont[
    Contextuals={Alternate}
]{Fira Code}
\makeatletter
\def\verbatim@nolig@list{}
\makeatother
\fi


\sisetup{%
    add-decimal-zero = true,%
    round-mode = places,%
    round-precision = 3%
}%

\newcommand{\sequence}[1]{%
    \relax\ifmmode\mathtt{#1}\else\texttt{#1}\fi%
}
\newcommand{\regex}[1]{%
    \relax\ifmmode\mathtt{#1}\else\texttt{#1}\fi%
}
\newcommand{\name}[1]{%
    \relax\ifmmode\mathbf{#1}\else\textbf{#1}\fi
}
\newcommand{\regexdefinitionsymbol}[1]{%
    \relax\ifmmode\mathit{#1}\else\textit{#1}\fi%
}
\newcommand{\grammarnonterminal}[1]{%
    \relax\ifmmode\mathit{#1}\else\textit{#1}\fi%
}
\newcommand{\grammarterminal}[1]{%
    \relax\ifmmode\mathbf{#1}\else\textbf{#1}\fi%
}
\newcommand{\grammarsingleletterterminal}[1]{%
    \relax\ifmmode\mathtt{#1}\else\texttt{#1}\fi%
}
\DeclareDocumentCommand{\firstset}{o}{%
    \ifmmode\mathrm{FIRST}\IfNoValueTF{#1}{}{\!\paren{#1}}%
    \else FIRST\IfNoValueTF{#1}{}{(#1)}%
    \fi
}
\DeclareDocumentCommand{\predictset}{o}{%
    \ifmmode\mathrm{PREDICT}\IfNoValueTF{#1}{}{\!\paren{#1}}%
    \else PREDICT\IfNoValueTF{#1}{}{(#1)}%
    \fi
}
\DeclareDocumentCommand{\followset}{o}{%
    \ifmmode\mathrm{FOLLOW}\IfNoValueTF{#1}{}{\!\paren{#1}}%
    \else FOLLOW\IfNoValueTF{#1}{}{(#1)}%
    \fi
}
